{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "VSkript",
	"scopeName": "source.sk",



	"patterns": [
		{ "include": "#comment"	},
		{ "include": "#options"	},
		{ "include": "#aliases"	},
		{ "include": "#command" },
		{ "include": "#event" },
		{ "include": "#function" },
		{ "include": "#grammar" },
		{ "include": "#variable" },
		{ "include": "#expr" }
	],



	"repository": {


		"comment": {
			"name": "vskript.comment",
			"match": "\\#(.*)",
			"captures": {
				"1": { "patterns": [ {"include": "#docs"} ] }
			}
		},
		"docs": {
			"match": "(\\@(parm|return))\\s(\\w*)",
			"captures": {
				"1": { "name": "vskript.docs.type" },
				"3": { "name": "vskript.docs.anno" }
			}
		},


		"options": {
			"begin": "^(options\\:)",
			"end": "^(?=[^\\t])",
			"beginCaptures": {
				"1": { "name": "vskript.options" }
			},
			"patterns": [
				{ "include": "#comment" },
				{ "include": "#options.list" }
			]
		},
		"options.list": {
			"match": "([^:]+)\\:(.+)",
			"captures": {
				"1": { "name": "vskript.options.list" },
				"2": {
					"patterns": [
						{ "include": "#comment" }
					]
				}
			}
		},


		"aliases": {
			"begin": "^(aliases\\:)",
			"end": "^(?=[^\\t])",
			"beginCaptures": {
				"1": { "name": "vskript.aliases" }
			},
			"patterns": [
				{ "include": "#comment" },
				{ "include": "#aliases.list" }
			]
		},
		"aliases.list": {
			"match": "([^=]+)\\=(.+)",
			"captures": {
				"1": { "name": "vskript.aliases.list" },
				"2": {
					"patterns": [
						{ "include": "#comment" },
						{ "include": "#expr.minecraftitem" }
					]
				}
			}
		},


		"command": {
			"patterns": [
				{	"include": "#command.define"	},
				{	"include": "#command.options"	}
			]
		},
		"command.define": {
			"name": "vskript.command",
			"begin": "^command",
			"end": "\\:",
			"patterns": [
				{	"include": "#variable.option"	}
			]
		},
		"command.options": {
			"match": "\\t(aliases|permission|trigger|description|usage)\\:(.*)",
			"captures": {
				"1": {	"name": "vskript.command.options"},
				"2": {	
					"patterns": [
						{	"include": "#variable"	}
					]
				}
			}
		},


		"event": {
			"name": "vskript.event",
			"match": "^on.*\\:"
		},


		"function": {
			"match": "^(function)\\s(\\w+\\((.*)\\))(\\:|\\s\\:\\:\\s([^:]+)\\:)",
			"captures": {
				"1": { "name": "vskript.function" },
				"2": { "name": "vskript.function.name" },
				"3": { "patterns": [ { "include": "#function.parameter" } ] },
				"4": { "name": "vskript.function.type" },
				"5": { "patterns": [ { "include": "#type" } ] }
			},
			"_comment": {
				"1": "prefix",
				"2": "function",
				"3": "parameter",
				"4": "return type",
				"5": "data type"
			}
		},
		"function.parameter": {
			"match": "([^():,]+):([^():,]+)",
			"captures": {
				"1": { },
				"2": { "patterns": [ { "include": "#type" } ] }
			},
			"_comment": {
				"1": "name",
				"2": "data type"
			}
		},


		"grammar": {
			"patterns": [
				{ "include": "#grammar.segment" },
				{ "include": "#grammar.effect" }
			]
		},
		"grammar.segment": {
			"match": "^(\\t|\\s)*(if|else if|else|while|loop)([^-]?.*)(\\:)",
			"captures": {
				"2": { "name": "vskript.grammar" },
				"3": {
					"patterns": [
						{ "include": "#variable" },
						{ "include": "#expr" },
						{ "include": "#grammar.effect" }
					]
				},
				"4": { "name": "vskript.grammar" }
			}
		},
		"grammar.effect": {
			"name": "vskript.grammar",
			"match": "\\b(if|return|exit|where|otherwise)\\b"
		},

		
		"type": {
			"patterns": [
				{ "include": "#type.attribute" },
				{ "include": "#type.biome" },
				{ "include": "#type.block" },
				{ "include": "#type.blockdata" },
				{ "include": "#type.boolean" },
				{ "include": "#type.cat" },
				{ "include": "#type.click" },
				{ "include": "#type.color" },
				{ "include": "#type.sender" },
				{ "include": "#type.date" },
				{ "include": "#type.difficulty" },
				{ "include": "#type.direction" },
				{ "include": "#type.enchantment" },
				{ "include": "#type.entity" },
				{ "include": "#type.experience" },
				{ "include": "#type.firework" },
				{ "include": "#type.gamemode" },
				{ "include": "#type.gamerule" },
				{ "include": "#type.gene" },
				{ "include": "#type.healreasons" },
				{ "include": "#type.integer" },
				{ "include": "#type.inventory" },
				{ "include": "#type.item" },
				{ "include": "#type.livingentity" },
				{ "include": "#type.location" },
				{ "include": "#type.metadataholder" },
				{ "include": "#type.number" },
				{ "include": "#type.object" },
				{ "include": "#type.offlineplayer" },
				{ "include": "#type.player" },
				{ "include": "#type.potion" },
				{ "include": "#type.projectile" },
				{ "include": "#type.region" },
				{ "include": "#type.resourcepackstate" },
				{ "include": "#type.servericon" },
				{ "include": "#type.soundcategory" },
				{ "include": "#type.spawnreason" },
				{ "include": "#type.teleportcause" },
				{ "include": "#type.text" },
				{ "include": "#type.time" },
				{ "include": "#type.timeperiod" },
				{ "include": "#type.timespan" },
				{ "include": "#type.tree" },
				{ "include": "#type.vector" },
				{ "include": "#type.visualeffect" },
				{ "include": "#type.weather" },
				{ "include": "#type.world" }
			]
		},
		"type.attribute": {
			"name": "vskript.type.attribute",
			"match": "\\battribute\\s?types?\\b"
		},
		"type.biome": {
			"name": "vskript.type.biome",
			"match": "\\bbiomes?\\b"
		},
		"type.block": {
			"name": "vskript.type.block",
			"match": "\\bblocks?\\b"
		},
		"type.blockdata": {
			"name": "vskript.type.blockdata",
			"match": "\\bblockdatas?\\b"
		},
		"type.boolean": {
			"name": "vskript.type.boolean",
			"match": "\\bbooleans?\\b"
		},
		"type.cat": {
			"name": "vskript.type.cat",
			"match": "\\bcat\\stypes?\\b"
		},
		"type.click": {
			"name": "vskript.type.click",
			"match": "\\bclick\\s?types?\\b"
		},
		"type.color": {
			"name": "vskript.type.color",
			"match": "\\bcolou?rs?\\b"
		},
		"type.sender": {
			"name": "vskript.type.sender",
			"match": "\\b(command\\s?)?senders?\\b"
		},
		"type.date": {
			"name": "vskript.type.date",
			"match": "\\bdates?\\b"
		},
		"type.difficulty": {
			"name": "vskript.type.difficulty",
			"match": "\\bdifficult(ys?|ies)\\b"
		},
		"type.direction": {
			"name": "vskript.type.direction",
			"match": "\\bdirections?\\b"
		},
		"type.enchantment": {
			"name": "vskript.type.enchantment",
			"match": "\\benchantment(\\s?type)?s?\\b"
		},
		"type.entity": {
			"name": "vskript.type.entity",
			"match": "\\bentit(ys?|ies)(\\s?type)?s?\\b"
		},
		"type.experience": {
			"name": "vskript.type.experience",
			"match": "\\bexperiences?\\b"
		},
		"type.firework": {
			"name": "vskript.type.firework",
			"match": "\\bfirework\\s?(effects|type)s?\\b"
		},
		"type.gamemode": {
			"name": "vskript.type.gamemode",
			"match": "\\bgame\\s?modes?\\b"
		},
		"type.gamerule": {
			"name": "vskript.type.gamerule",
			"match": "\\bgamerule(\\svalue)?s?\\b"
		},
		"type.gene": {
			"name": "vskript.type.gene",
			"match": "\\bgenes?\\b"
		},
		"type.healreasons": {
			"name": "vskript.type.healreasons",
			"match": "\\bheal\\sreasons?\\b"
		},
		"type.integer": {
			"name": "vskript.type.integer",
			"match": "\\bintegers?\\b"
		},
		"type.inventory": {
			"name": "vskript.type.inventory",
			"match": "\\binventor(y((\\s?(action|slot|type))?s?)|ies)\\b"
		},
		"type.item": {
			"name": "vskript.type.attribute",
			"match": "\\bitem(\\s?type)?s?\\b"
		},
		"type.livingentity": {
			"name": "vskript.type.attribute",
			"match": "\\bliving\\s?entit(ys?|ies)\\b"
		},
		"type.location": {
			"name": "vskript.type.attribute",
			"match": "\\blocations?\\b"
		},
		"type.metadataholder": {
			"name": "vskript.type.attribute",
			"match": "\\bmetadata\\s?holders?\\b"
		},
		"type.number": {
			"name": "vskript.type.attribute",
			"match": "\\bnumbers?\\b"
		},
		"type.object": {
			"name": "vskript.type.attribute",
			"match": "\\bobjects?\\b"
		},
		"type.offlineplayer": {
			"name": "vskript.type.attribute",
			"match": "\\boffline\\s?players?\\b"
		},
		"type.player": {
			"name": "vskript.type.attribute",
			"match": "\\bplayers?\\b"
		},
		"type.potion": {
			"name": "vskript.type.attribute",
			"match": "\\bpotion\\s?effect\\s?types?\\b"
		},
		"type.projectile": {
			"name": "vskript.type.attribute",
			"match": "\\bprojectiles?\\b"
		},
		"type.region": {
			"name": "vskript.type.attribute",
			"match": "\\bregions?\\b"
		},
		"type.resourcepackstate": {
			"name": "vskript.type.attribute",
			"match": "\\bresource\\s?pack\\s?states?\\b"
		},
		"type.servericon": {
			"name": "vskript.type.attribute",
			"match": "\\bserver\\s?icons?\\b"
		},
		"type.soundcategory": {
			"name": "vskript.type.attribute",
			"match": "\\bsound\\scategor(ys?|ies)\\b"
		},
		"type.spawnreason": {
			"name": "vskript.type.attribute",
			"match": "\\bspawn\\s?reasons?\\b"
		},
		"type.teleportcause": {
			"name": "vskript.type.attribute",
			"match": "\\bteleport\\s?causes?\\b"
		},
		"type.text": {
			"name": "vskript.type.text",
			"match": "\\btexts?\\b"
		},
		"type.time": {
			"name": "vskript.type.attribute",
			"match": "\\btimes?\\b"
		},
		"type.timeperiod": {
			"name": "vskript.type.attribute",
			"match": "\\btime\\s?periods?\\b"
		},
		"type.timespan": {
			"name": "vskript.type.attribute",
			"match": "\\btimespans?\\b"
		},
		"type.tree": {
			"name": "vskript.type.attribute",
			"match": "\\btree(\\s?type)?s?\\b"
		},
		"type.vector": {
			"name": "vskript.type.attribute",
			"match": "\\bvectors?\\b"
		},
		"type.visualeffect": {
			"name": "vskript.type.attribute",
			"match": "\\bvisual\\seffects?\\b"
		},
		"type.weather": {
			"name": "vskript.type.attribute",
			"match": "\\bweather(\\s?type)?s?\\b"
		},
		"type.world": {
			"name": "vskript.type.attribute",
			"match": "\\bworlds?\\b"
		},


		"expr": {
			"patterns": [
				{ "include": "#expr.text" },
				{ "include": "#expr.number" },
				{ "include": "#expr.grammar" },
				{ "include": "#expr.minecraftitem" },
				{ "include": "#expr.aliases" },
				{ "include": "#expr.fucntion" }
			]
		},
		"expr.text": {
			"name": "vskript.expr.text",
			"begin": "\"",
			"end": "\"",
			"patterns": [
				{ "include": "#expr.text" }
			]
		},
		"expr.number": {
			"name": "vskript.expr.number",
			"match": "\\-?[\\d](\\.\\d)?"
		},
		"expr.grammar": {
			"name": "vskript.expr.grammar",
			"match": "(the )?(event\\-\\w*|arg\\-\\w*|loop\\-\\w*(\\-\\d)?)"
		},
		"expr.minecraftitem": {
			"name": "vskript.expr.minecraftitem",
			"match": "minecraft\\:[^\\s\\,]*"
		},
		"expr.aliases": {
			"name": "vskript.expr.aliases",
			"begin": "\\'\\'",
			"end": "\\'\\'"
		},
		"expr.fucntion": {
			"begin": "(\\w+\\()",
			"end": "(\\))",
			"beginCaptures": {
				"1": { "name": "vskript.expr.function" }
			},
			"endCaptures": {
				"1": { "name": "vskript.expr.function" }
			},
			"patterns": [
				{ "include": "#variable"},
				{ "include": "#expr"},
				{ "include": "#expr.fucntion.argument"}
			]
		},
		"expr.fucntion.argument": {
			"match": "(\"[^\"]*\")|(\\,)",
			"captures": {
				"1": { 
					"patterns": [
						{ "include": "#expr.text"}
					]
				},
				"2": { }
			}
		},


		"variable": {
			"patterns": [
				{	"include": "#variable.option"	},
				{	"include": "#variable.local"	},
				{	"include": "#variable.runtime"	},
				{	"include": "#variable.normal"	}
			]
		},
		"variable.option": {
			"name": "vskript.variable.option",
			"begin": "\\{\\@",
			"end": "\\}"
		},
		"variable.local": {
			"name": "vskript.variable.local",
			"begin": "\\{\\_",
			"end": "\\}",
			"patterns": [
				{	"include": "#variable.option"	},
				{	"include": "#variable.runtime"	},
				{	"include": "#variable.local"	}
			]
		},
		"variable.runtime": {
			"name": "vskript.variable.runtime",
			"begin": "\\{\\-",
			"end": "\\}",
			"patterns": [
				{	"include": "#variable.option"	},
				{	"include": "#variable.local"	},
				{	"include": "#variable.runtime"	}
			]
		},
		"variable.normal": {
			"name": "vskript.variable.normal",
			"begin": "\\{",
			"end": "\\}",
			"patterns": [
				{	"include": "#variable.option"	},
				{	"include": "#variable.local"	},
				{	"include": "#variable.runtime"	},
				{	"include": "#variable.normal"	}
			]
		}
	}
}